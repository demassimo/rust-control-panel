<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Rust Control Panel – Server</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="/assets/css/dark-theme.css" />
    <script defer src="/assets/modules/module-loader.js"></script>
    <script defer src="/assets/modules/players-graph.js"></script>
    <script defer src="/assets/modules/live-console.js"></script>
    <script defer src="/assets/modules/map.js"></script>
    <script defer src="/assets/modules/live-players.js"></script>
    <script defer src="/assets/modules/players.js"></script>
    <script defer src="/assets/js/panel-shell.js"></script>
  </head>
<body class="app">
  <header class="topbar">
    <a class="back" href="/servers">← Back to Servers</a>
    <div class="server-title">
      <div class="name" id="srv-name">Main PvP Server</div>
      <div class="meta" id="srv-endpoint">192.168.1.100:28015 · <span id="srv-online">online</span></div>
    </div>
    <div class="actions">
      <button class="btn ghost" id="btn-fullmap" title="Open full map">🗺 Show Full Map</button>
      <span class="badge success" id="srv-status">online</span>
    </div>
  </header>

  <main class="server-panel">
    <nav class="server-menu" aria-label="Server sections">
      <button class="menu-tab active" type="button" data-target="players">Players</button>
      <button class="menu-tab" type="button" data-target="map">Map</button>
      <button class="menu-tab" type="button" data-target="console">Console</button>
      <button class="menu-tab" type="button" data-target="dashboard">Dashboard</button>
    </nav>

    <section class="view-panel active" data-view="players">
      <div class="card full-width">
        <div class="card-head">
          <div class="card-title">Player History</div>
        </div>
        <div class="card-body players-graph-body">
          <div class="players-graph" data-module="players-graph"
               data-props='{"serverId":"__SERVER_ID__"}'></div>
        </div>
      </div>

      <div class="card full-width">
        <div class="card-head">
          <div class="card-title">Current Players <span id="player-count" class="muted">(0)</span></div>
          <div class="card-tools">
            <button class="btn ghost small" id="show-all">Show everyone</button>
          </div>
        </div>
        <div class="card-body no-pad players-strip">
          <div class="live-players-board" data-module="live-players"
               data-props='{"serverId":"__SERVER_ID__"}'></div>
        </div>
      </div>

      <div class="card full-width">
        <div class="card-head">
          <div class="card-title">All Players</div>
        </div>
        <div class="card-body players-directory" data-module="players-directory"
             data-props='{"serverId":"__SERVER_ID__"}'></div>
      </div>
    </section>

    <section class="view-panel" data-view="map">
      <div class="card full-width map-card">
        <div class="card-head">
          <div class="card-title">Live Map</div>
        </div>
        <div class="card-body no-pad">
          <div class="map-wrap" data-module="live-map" id="live-map-slot"
               data-props='{"serverId":"__SERVER_ID__"}'></div>
        </div>
      </div>
    </section>

    <section class="view-panel" data-view="console">
      <div class="card full-width">
        <div class="card-head">
          <div class="card-title">Console</div>
        </div>
        <div class="card-body no-pad">
          <div class="console" data-module="live-console" data-props='{}'></div>
        </div>
        <div class="console-input">
          <input type="text" id="console-cmd" placeholder="Enter console command..." />
          <button class="btn danger" id="console-send">Send</button>
        </div>
      </div>
    </section>

    <section class="view-panel" data-view="dashboard">
      <div class="card full-width">
        <div class="card-head">
          <div class="card-title" id="info-title">Server Info</div>
        </div>
        <div class="card-body" id="info-content">
          <div data-module="server-info" data-props='{"serverId":"__SERVER_ID__"}'></div>
        </div>
        <div class="card-foot" id="info-actions">
          <button class="btn ghost" id="btn-restart">Restart Server</button>
          <button class="btn ghost" id="btn-saveworld">Save World</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabs = Array.from(document.querySelectorAll('.menu-tab'));
      const views = Array.from(document.querySelectorAll('.view-panel'));

      function activate(target) {
        tabs.forEach((btn) => {
          const isActive = btn.dataset.target === target;
          btn.classList.toggle('active', isActive);
          btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
        });
        views.forEach((panel) => {
          panel.classList.toggle('active', panel.dataset.view === target);
        });
      }

      tabs.forEach((btn) => {
        btn.addEventListener('click', () => activate(btn.dataset.target));
      });

      activate('players');
    });
  </script>
</body>
</html>
